{% extends "layout.html" %}

{% block content %}
<div class="row mb-4">
    <div class="col">
        <div class="d-flex justify-content-between align-items-center">
            <h2 class="border-bottom pb-2"><i class="fas fa-chart-pie me-2"></i>Data Visualization Dashboard</h2>
            <a href="{{ url_for('reports.index') }}" class="btn btn-secondary">
                <i class="fas fa-arrow-left me-1"></i>Back to Reports
            </a>
        </div>
    </div>
</div>

<div class="alert alert-info mb-4">
    <i class="fas fa-info-circle me-2"></i><strong>Date Range:</strong> {{ start_date.strftime('%Y-%m-%d') }} to {{ end_date.strftime('%Y-%m-%d') }}
</div>

<div class="row mb-4">
    <div class="col-md-6">
        <div class="card shadow h-100">
            <div class="card-header bg-primary text-white">
                <h5 class="mb-0"><i class="fas fa-pie-chart me-2"></i>Equipment Status Distribution</h5>
            </div>
            <div class="card-body">
                <img src="{{ status_chart }}" class="img-fluid" alt="Equipment Status Distribution">
            </div>
        </div>
    </div>
    
    <div class="col-md-6">
        <div class="card shadow h-100">
            <div class="card-header bg-success text-white">
                <h5 class="mb-0"><i class="fas fa-industry me-2"></i>Equipment by Manufacturer</h5>
            </div>
            <div class="card-body">
                <img src="{{ manufacturer_chart }}" class="img-fluid" alt="Equipment by Manufacturer">
            </div>
        </div>
    </div>
</div>

<div class="row mb-4">
    <div class="col">
        <div class="card shadow">
            <div class="card-header bg-warning text-dark">
                <h5 class="mb-0"><i class="fas fa-chart-line me-2"></i>Maintenance Activities Timeline</h5>
            </div>
            <div class="card-body">
                <img src="{{ timeline_chart }}" class="img-fluid" alt="Maintenance Timeline">
            </div>
        </div>
    </div>
</div>

<div class="row mb-4">
    <div class="col">
        <div class="card shadow">
            <div class="card-header bg-info text-white">
                <h5 class="mb-0"><i class="fas fa-chart-bar me-2"></i>Technician Performance</h5>
            </div>
            <div class="card-body">
                <img src="{{ technician_chart }}" class="img-fluid" alt="Technician Performance">
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-md-6">
        <div class="card shadow">
            <div class="card-header bg-danger text-white">
                <h5 class="mb-0"><i class="fas fa-download me-2"></i>Export Options</h5>
            </div>
            <div class="card-body">
                <div class="list-group">
                    <a href="{{ url_for('reports.export') }}?report_type=maintenance_history&start_date={{ start_date.strftime('%Y-%m-%d') }}&end_date={{ end_date.strftime('%Y-%m-%d') }}" class="list-group-item list-group-item-action">
                        <div class="d-flex w-100 justify-content-between">
                            <h5 class="mb-1"><i class="fas fa-history me-2"></i>Maintenance History</h5>
                            <small><i class="fas fa-file-csv"></i></small>
                        </div>
                        <p class="mb-1">Export complete maintenance history for the selected period</p>
                    </a>
                    <a href="{{ url_for('reports.export') }}?report_type=equipment_status" class="list-group-item list-group-item-action">
                        <div class="d-flex w-100 justify-content-between">
                            <h5 class="mb-1"><i class="fas fa-snowflake me-2"></i>Equipment Status</h5>
                            <small><i class="fas fa-file-csv"></i></small>
                        </div>
                        <p class="mb-1">Export current status of all equipment</p>
                    </a>
                    <a href="{{ url_for('reports.export') }}?report_type=technician_performance&start_date={{ start_date.strftime('%Y-%m-%d') }}&end_date={{ end_date.strftime('%Y-%m-%d') }}" class="list-group-item list-group-item-action">
                        <div class="d-flex w-100 justify-content-between">
                            <h5 class="mb-1"><i class="fas fa-users me-2"></i>Technician Performance</h5>
                            <small><i class="fas fa-file-csv"></i></small>
                        </div>
                        <p class="mb-1">Export technician performance metrics for the selected period</p>
                    </a>
                </div>
            </div>
        </div>
    </div>
    
    <div class="col-md-6">
        <div class="card shadow">
            <div class="card-header bg-secondary text-white">
                <h5 class="mb-0"><i class="fas fa-lightbulb me-2"></i>Insights & Recommendations</h5>
            </div>
            <div class="card-body">
                <div class="alert alert-success mb-3">
                    <h6 class="alert-heading"><i class="fas fa-check-circle me-2"></i>Positive Findings</h6>
                    <ul class="mb-0">
                        <li>Active equipment rate is {{ (status_counts.active / (status_counts.active + status_counts.maintenance + status_counts.inactive) * 100)|round|int }}% - a good utilization rate</li>
                        <li>Recent maintenance activities show consistent care of equipment</li>
                        <li>Technician efficiency is improving over time</li>
                    </ul>
                </div>
                
                <div class="alert alert-warning mb-3">
                    <h6 class="alert-heading"><i class="fas fa-exclamation-triangle me-2"></i>Areas for Improvement</h6>
                    <ul class="mb-0">
                        <li>{{ needs_maintenance|length if needs_maintenance else 0 }} equipment units need maintenance soon</li>
                        <li>Consider more regular maintenance for heavily used equipment</li>
                        <li>Balance workload among technicians more evenly</li>
                    </ul>
                </div>
                
                <div class="alert alert-info mb-0">
                    <h6 class="alert-heading"><i class="fas fa-info-circle me-2"></i>Next Steps</h6>
                    <ul class="mb-0">
                        <li>Schedule maintenance for equipment that hasn't been serviced in 30+ days</li>
                        <li>Review maintenance plans for equipment with recurring issues</li>
                        <li>Provide additional training for technicians with longer average maintenance durations</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
